(function(d){var r={init:function(f){function v(a){d.get(b.api.url,{method:"flickr.photosets.getPhotos",api_key:b.api.key,photoset_id:a,format:"json"},function(g){g.stat=="fail"?c.html(g.message+". Photoset: "+a):n(g.photoset.photo)},"json")}function w(){d.get(b.api.url,{method:"flickr.people.getPublicPhotos",api_key:b.api.key,user_id:j,format:"json"},function(a){a.stat=="fail"?c.html(a.message+". User id: "+j):n(a.photos.photo)},"json")}function x(a){d.get(b.api.url,{method:"flickr.photos.search",
api_key:b.api.key,user_id:j,text:a,format:"json"},function(g){g.stat=="fail"?c.html(g.message+". Search string: "+a):n(g.photos.photo)},"json")}function n(a){var g=d('<div class="flickry-viewer" />'),s=d('<div class="flickry-thumbnails" />');c.append(g);c.append(s);k=0;d.each(a,function(h,e){if(!(h>=b.limit)){k+=1;var t=d('<div class="image" />'),i=d("<img />").attr({src:"http://farm"+e.farm+".static.flickr.com/"+e.server+"/"+e.id+"_"+e.secret+".jpg",alt:e.title,title:e.title,"data-photo-index":h+
1});i.hide();t.append(i);m[h]=i;g.append(t);i=d("<img />").attr({src:"http://farm"+e.farm+".static.flickr.com/"+e.server+"/"+e.id+"_"+e.secret+"_s.jpg",alt:e.title,title:e.title,width:b.thumbnailSize,height:b.thumbnailSize,"data-photo-index":h});s.append(i);o[h]=i}});d("img",c).bind("click",function(){var h=d(this).attr("data-photo-index");p(h)});if(k){a=m[0];o[0].addClass("hover");a.fadeIn(b.fadeDuration)}if(b.keyboardControl){c.bind("mouseover",function(){c.data("hover",1)});c.bind("mouseout",function(){c.data("hover",
0)});d(document).bind("keyup",function(h){if(!b.keyboardOnHover||c.data("hover")==1)if(h.keyCode==37)p(l-1);else h.keyCode==39&&p(l+1)})}}function p(a){if(a>=k)a=0;if(a<0)a=k-1;m[l].fadeOut(b.fadeDuration);m[a].fadeIn(b.fadeDuration,function(){l=a;d(".flickry-thumbnails img",c).removeClass("hover");o[l].addClass("hover")})}var c=d(this),m=[],o=[],b={api:{url:"http://api.flickr.com/services/rest/?jsoncallback=?",key:"ebe7787af56999af2687900ba2219380"},thumbnailSize:25,keyboardControl:true,keyboardOnHover:true,
fadeDuration:250,setId:"",userId:"",search:"",limit:50};d.extend(true,b,f);c.addClass("flickry");f=c.attr("data-set-id")||b.setId;var j=c.attr("data-user-id")||b.userId,q=c.attr("data-search")||b.search,u=c.attr("data-limit")||b.limit;if(u)b.limit=u;var l=0,k;if(f)v(f);else if(j&&!q)w(j);else q&&x(q)}};d.fn.flickry=function(f){argv=arguments;return this.each(function(){if(r[f])return r[f].apply(this,Array.prototype.slice.call(argv,1));else if(typeof f==="object"||!f){options=[f];return r.init.apply(this,
options)}})}})(jQuery);